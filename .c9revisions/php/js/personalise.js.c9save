{"ts":1341932692975,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var MSG_TYPE = { //It has a duplicate in snake.js\n        DATABASE_UPDATED: 'DATABASE_UPDATED',\n        UPLOAD_DATA: 'UPLOAD_DATA',\n        UPDATE_PAGE: 'UPDATE_PAGE'\n    },\n    xmlhttp,\n    data,\n    username,\n    email,\n    uid;\nfunction getCookie(c_name) {\n    var i,x,y,ARRcookies=document.cookie.split(\";\");\n    for (i=0;i<ARRcookies.length;i++) {\n        x=ARRcookies[i].substr(0,ARRcookies[i].indexOf(\"=\"));\n        y=ARRcookies[i].substr(ARRcookies[i].indexOf(\"=\")+1);\n        x=x.replace(/^\\s+|\\s+$/g,\"\");\n        if (x==c_name) {\n            return unescape(y);\n        }\n    }\n}\nxmlhttp = new XMLHttpRequest();\n(function() {\n    var first_get = 1;//Means its the first time we are contacting database\n    uid = getCookie('uid');\n    if(!uid) {\n        email = prompt('New Comer !!\\nPls provide your email');\n        username = \"DEFAULT\";\n        xmlhttp.open('GET','http://php-hariombalhara.rhcloud.com/process.php?name='+username+'&email='+email+'&firstget='+first_get,true);\n        xmlhttp.send(null);\n    } else {\n        xmlhttp.open('GET','http://php-hariombalhara.rhcloud.com/process.php?firstget='+first_get,true);\n        xmlhttp.send(null);\n    }\n    xmlhttp.onreadystatechange = function() {\n        var container = {};\n        if(xmlhttp.status == 200 && xmlhttp.readyState == 4) {\n            console.log('Fetching Data from database');\n                data = eval('('+xmlhttp.responseText+')');\n                console.log('Received Data:',JSON.stringify(data));\n            }\n            container.data = data;\n            container.msgType = MSG_TYPE.UPDATE_PAGE;\n            window.parent.postMessage(container, '*');\n    };\n})();\nwindow.onmessage = function(e) {\n    var container = e.data,\n        score;\n    console.log('Updating Score');\n    if(container.msgType === MSG_TYPE.UPLOAD_DATA) {\n        score = container.score;\n    }    \n    xmlhttp.onreadystatechange = function(){\n        container.msgType = MSG_TYPE.DATABASE_UPDATED;\n        window.parent.postMessage(container,'*');    \n    };\n    xmlhttp.open('GET','http://php-hariombalhara.rhcloud.com/process.php?score='+score,true);\n    xmlhttp.send(null);\n};"]],"start1":0,"start2":0,"length1":0,"length2":2147}]],"length":2147}
