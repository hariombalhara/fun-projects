{"ts":1341845610979,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<?php\nheader('Access-Control-Allow-Origin:*');\nheader('Content-Type:text/html');\n$uuid = $_COOKIE['identifier'];\n//echo $uuid;\n$host = $_ENV['OPENSHIFT_DB_HOST'];\n$pass = $_ENV['OPENSHIFT_DB_PASSWORD'];\n$username = $_ENV['OPENSHIFT_DB_USERNAME'];\n$port = $_ENV['OPENSHIFT_DB_PORT'];\n$conn = mysql_connect($host.\":\".$port,$username,$pass);\n$name = $_GET['name']; //TODO CHANGE TO POST\n$email = $_GET['email'];\n$score = $_GET['score'];\nif(!$conn)\n{\n    die('Error Connecting:'.mysql_error());\n}\nmysql_select_db('php',$conn);\n//echo $conn;\nif(isset($uuid)) {\n    if(!isset($score)) {\n        $query = 'Select * from `snake` where `sessionId` = \"'.$uuid.'\"';\n      //  echo $query;\n        $res = mysql_query($query) or die(mysql_error());\n        $row = mysql_fetch_array($res,MYSQL_BOTH);\n        echo \"{\n                'email':'\".$row['email'].\"',\n                'score':\".$row['highestScore'].\"\n              }\";\n        //print_r($row);\n    } else {\n        $query = 'Update `snake` set `highestScore` = '.$score.' where `sessionId` = \"'.$uuid.'\"';\n        //echo $query;\n        $res = mysql_query($query) or die(mysql_error());\n        //$row = mysql_fetch_array($res,MYSQL_BOTH);\n    }\n  \n} else {\n   global $uuid;\n   global $name;\n   global $email;\n   $uuid = uniqid();\n   $query = \"Insert into `snake` (`email`,`sessionId`,`username`) values ('\".$email.\"','\".$uuid.\"','\".$name.\"')\";\n   //echo $query;\n   $res = mysql_query($query) or die(mysql_error());\n   //echo \"Insert \".$res;\n   setcookie('identifier',$uuid);\n}\n?>"]],"start1":0,"start2":0,"length1":0,"length2":1526}]],"length":1526}
